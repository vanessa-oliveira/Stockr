<div class="content">
  <p-button
    class="add-product-button"
    label="Adicionar produto"
    icon="pi pi-plus"
    (click)="openProductForm()"
  />

  <app-product-form [(visible)]="visible" [product]="selectedProduct" (productChanged)="loadProducts()"></app-product-form>

  <div class="list">
    <p-table
      [value]="products"
      [tableStyle]="{ 'min-width': '70rem' }"
      [paginator]="true"
      [rows]="pageSize"
      [totalRecords]="totalCount"
      [lazy]="true"
      (onPage)="pageChange($event)"
      [rowsPerPageOptions]="[10, 20, 30, 50]"
      [showCurrentPageReport]="true"
      currentPageReportTemplate="Mostrando {first} a {last} de {totalRecords} registros"
    >
      <ng-template #header>
        <tr>
          <th>SKU</th>
          <th>Nome</th>
          <th>Categoria</th>
          <th>Fornecedor</th>
          <th>Preço Custo</th>
          <th>Preço Venda</th>
          <th>Ações</th>
        </tr>
      </ng-template>
      <ng-template #body let-product>
        <tr>
          <td>
            <div class="product-sku">
              {{ product.sku }}
            </div>
          </td>
          <td>{{ product.name }}</td>
          <td>{{ product.category?.name || '-' }}</td>
          <td>{{ product.supplier?.name || '-' }}</td>
          <td>{{ product.costPrice | currency:'BRL':'symbol':'1.2-2' }}</td>
          <td>{{ product.salePrice | currency:'BRL':'symbol':'1.2-2' }}</td>
          <td class="actions">
            <p-button
              icon="pi pi-pencil"
              [rounded]="true"
              [text]="true"
              severity="secondary"
              (click)="editProduct(product)"
              pTooltip="Editar produto"
              tooltipPosition="top"
            />
            <p-button
              icon="pi pi-trash"
              [rounded]="true"
              [text]="true"
              severity="danger"
              (click)="deleteProduct(product)"
              pTooltip="Excluir produto"
              tooltipPosition="top"
            />
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>
  <p-confirmDialog></p-confirmDialog>
</div>
